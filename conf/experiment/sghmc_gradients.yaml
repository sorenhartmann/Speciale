# @package _global_
defaults:
  - /variance_estimator: inter_batch
  - override /model : mlp_classifier
  - override /inference : mcmc
  - override /sampler : sghmc_with_grad_est
  - override /sample_container : all
  - override /data : mnist
  - _self_

out_dir : sghmc_gradients

inference:
  burn_in: 0
  sampler:
    variance_estimator:
      _target_: src.experiments.sghmc_gradients.VarianceEstimatorWrapper
      variance_estimator: ${variance_estimator}
      use_estimate: False
      constant: 0.

trainer:
  max_epochs: 50
  progress_bar_refresh_rate: 0
  callbacks:
    - _target_: pytorch_lightning.callbacks.ModelCheckpoint
      dirpath: "./checkpoints"
    - _target_: src.experiments.sghmc_gradients.LogVarianceEstimates
    - _target_: src.utils.SilenceWarnings
