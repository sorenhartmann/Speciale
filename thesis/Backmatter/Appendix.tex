\chapter{Simulated Polynomial Regression } \label{apx:simulated-joint}

\begin{figure}[htbp]
    \centering
    \includegraphics{Figures/pol_model.pdf}
    \caption{Polynomial model and simulated training data.}
    \label{fig:pol-model}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{Figures/simulated_pairs_HMC_15.pdf}
    \caption{Pairwise joint distributions of samples from polynomial Bayesian regressison example, using the HMC algorithm conditioned on every datapoint.}
    \label{fig:pairs-hmc-15}
\end{figure}
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{Figures/simulated_pairs_HMC_5.pdf}
    \caption{Pairwise joint distributions of samples from polynomial Bayesian regressison example, using the naive batched HMC algorithm using a batch size of 5.}
    \label{fig:pairs-hmc-5}
\end{figure}
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{Figures/simulated_pairs_SGHMC_5.pdf}
    \caption{Pairwise joint distributions of samples from polynomial Bayesian regressison example, using the SGHMC algorithm using a batch size of 5.}
    \label{fig:pairs-sghmc-5}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{Figures/simulated_pairs_SGHMCWithVarianceEstimator_5.pdf}
    \caption{Pairwise joint distributions of samples from polynomial Bayesian regressison example, using the SGHMC algorithm with gradient variance estimation  and a batch size of 5.}
    \label{fig:pairs-sghmc-var-est-5}
\end{figure}

\FloatBarrier
\chapter{Hyperparameter Sweeps} 

\section{MNIST} \label{apx:mnist-sweep}



\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/mnist-sgd-map-hparams}
    }
    \caption{Top hyperparameters for FFNN model trained using SGD (MAP) on the MNIST dataset according to optuna sweep.}
    \label{tab:mnist-sgd-map-hparams}
\end{table}

\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/mnist-sgd-dropout-hparams}
    }
    \caption{Top hyperparameters for FFNN model trained using SGD (with dropout) on the MNIST dataset according to optuna sweep.}
    \label{tab:mnist-sgd-dropout-hparams}
\end{table}

\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/mnist-sghmc-hparams}
    }
    \caption{Top hyperparameters for FFNN model trained using SGHMC on the MNIST dataset according to optuna sweep.}
    \label{tab:mnist-sghmc-hparams}
\end{table}


\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/mnist-sghmc-var-est-hparams}
    }
    \caption{Top hyperparameters for FFNN model trained using SGHMC (with variance estimation) on the MNIST dataset according to optuna sweep.}
    \label{tab:mnist-sghmc-var-est-hparams}
\end{table}



\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/mnist-vi-hparams}
    }
    \caption{Top hyperparameters for FFNN model trained using VI the on the MNIST dataset according to optuna sweep.}
    \label{tab:mnist-vi-hparams}
\end{table}


\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/mnist-vi-exp-weighted-hparams}
    }
    \caption{Top hyperparameters for FFNN model trained using VI (with exponentially scaled KL weight) on the MNIST dataset according to optuna sweep.}
    \label{tab:mnist-vi-exp-weighted-hparams}
\end{table}



\begin{table}[H]
    \centering
    \begin{tabular}{p{4cm}p{9cm}}
        \toprule
        Algorithm & Parameters chosen \\ \midrule
        SGD (dropout) & $\texttt{lr}=5\times 10^{-4}$,
        $\texttt{dropout}=0.3$ \\ \midrule
        SGD (MAP) & 
        $\texttt{lr}=4 \times 10^{-4}$, 
        $\log\sigma_1=0$, 
        $\log\sigma_2=-7$, 
        $\texttt{mixture\_ratio}=0.7$ \\ \midrule
        SGHMC & $\texttt{lr}=10^{-6}$, $\alpha=0.05$ \\ \midrule
        SGHMC (with variance estimate) &  $\texttt{lr}= 5 \times 10^{-8}$, 
        $\alpha=0.003$,
        $\texttt{estimation\_margin}=20$ \\ \midrule
        Variational inference &    
        $\texttt{lr}=4 \times 10^{-4}$,
        $\log\sigma_1=0$,
        $\log\sigma_2=-7$,
        $\texttt{mixture\_ratio}=0.4$,
        $\texttt{n\_particles}=8$ \\
        \bottomrule
    \end{tabular}
    \caption{Chosen hyperparameters the different methods for FFNN model trained on MNIST.}
    \label{tab:mnist-hparams}
\end{table}

\FloatBarrier

\section{CIFAR10 - Convolutional Model}

\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/cifar-small-sgd-map-hparams}
    }
    \caption{Top hyperparameters for convolutional model trained using SGD (MAP) on the CIFAR10 dataset according to optuna sweep.}
    \label{tab:cifar-small-sgd-map-hparams}
\end{table}

\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/cifar-small-sgd-dropout-hparams}
    }
    \caption{Top hyperparameters for convolutional model trained using SGD (with dropout) on the CIFAR10 dataset according to optuna sweep.}
    \label{tab:cifar-small-sgd-dropout-hparams}
\end{table}

\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/cifar-small-sghmc-hparams}
    }
    \caption{Top hyperparameters for convolutional model trained using SGHMC on the CIFAR10 dataset according to optuna sweep.}
    \label{tab:cifar-small-sghmc-hparams}
\end{table}

\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/cifar-small-sghmc-var-est-hparams}
    }
    \caption{Top hyperparameters for convolutional model trained using SGHMC (with variance estimation) on the CIFAR10 dataset according to optuna sweep.}
    \label{tab:cifar-small-sghmc-var-est-hparams}
\end{table}

\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/cifar-small-vi-hparams}
    }
    \caption{Top hyperparameters for convolutional model trained using VI the on CIFAR10 dataset according to optuna sweep.}
    \label{tab:cifar-small-vi-hparams}
\end{table}

\begin{table}[H]
    \centering
    \resizebox{
        \ifdim\width>\columnwidth
        \columnwidth
      \else
        \width
      \fi
    }{!}{\small
    \input{Tables/cifar-small-vi-exp-weighted-hparams}
    }
    \caption{Top hyperparameters for convolutional model trained using VI (with exponentially scaled KL weight) on the CIFAR10 dataset according to optuna sweep.}
    \label{tab:cifar-small-vi-exp-weighted-hparams}
\end{table}


\FloatBarrier
\section{CIFAR10 - DenseNet} \label{apx:densenet-params}

\begin{table}[H]
    \centering
    \begin{tabular}{p{4cm}p{9cm}}
        \toprule
        Algorithm & Parameters chosen \\ \midrule
        SGD (no dropout) & $\texttt{lr}=2\times 10^{-4}$, \\ \midrule
        SGD (dropout=0.3) & $\texttt{lr}=5\times 10^{-4}$, \\ \midrule
        SGD (dropout=0.6) & $\texttt{lr}=5\times 10^{-4}$,  \\ \midrule
        SGD (MAP) & 
        $\texttt{lr}=2 \times 10^{-4}$, 
        $\log\sigma_1=-2$, 
        $\log\sigma_2=-8$, 
        $\texttt{mixture\_ratio}=0.7$ \\ \midrule
        SGHMC & $\texttt{lr}=1\times 10^{-7}$, $\alpha=0.05$, $\texttt{resample\_momentum\_every}=10000$ \\ \midrule
        SGHMC (with variance estimate) &  $\texttt{lr}= 5\times 10^{-8}$, 
        $\alpha=0.05$,
        $\texttt{estimation\_margin}=5$, $\texttt{resample\_momentum\_every}=10000$ \\ \midrule
        Variational inference &    
        $\texttt{lr}=4 \times 10^{-4}$,
        $\log\sigma_1=-2$,
        $\log\sigma_2=-8$,
        $\texttt{mixture\_ratio}=0.4$,
        $\texttt{n\_particles}=5$ \\
        \bottomrule
    \end{tabular}
    \caption{Chosen hyperparameters the different methods for DenseNet model trained on CIFAR10.}
    \label{tab:densenet-hparams}
\end{table}
