% spellchecker: disable


\begin{tikzpicture}
    \node[
        class, 
        fill=none,
        rectangle, 
        rectangle split, 
        rectangle split parts=7,
        rectangle split horizontal, 
        rectangle split part fill={
            grey,
            grey,
            brightgreen,
            white,
            white,
            white,
            white
            },
        minimum height=1cm,
        inner sep=2,
        rounded corners
        ] (samples) {
            \nodepart{one}
            \nodepart{two}
            \nodepart{three} \texttt{i}
            \nodepart{four}
            \nodepart{five}
            \nodepart{six}
            \nodepart{seven}
        };
    \node[class,fill=blue!50, below=1.5cm of samples] (bayesian-module) {BayesianModule};
    % \begin{scope}[on background layer]
        % \end{scope}
    \draw [->] (samples.three south) -- (bayesian-module.north -| samples.three south);
    \draw[decorate,decoration={brace, amplitude=10pt, raise=2pt}]
    (samples.one north) to node[black,midway,above=10pt] (samples-label) {\small{$n$ samples}} (samples.seven north);%
    \node (inf-modules) [back group] [fit=(bayesian-module)(samples)(samples-label),label={above:VariationalModule}]{};
    \node [other,left=of bayesian-module] (input) {$x$};
    \node [other,right=of bayesian-module] (output) {$x^\prime$};
    \draw [depends] (input) -- (bayesian-module);
    \draw [depends] (bayesian-module) -- (output);
    \draw [depends](bayesian-module.east) to[out=0,in=330, edge node={node [sloped,above] {\tiny \texttt{i++}}}] (samples.south east);
    \end{tikzpicture}
